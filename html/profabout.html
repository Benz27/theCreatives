<?php
session_start();

include("../php/conn.php");
include("../php/read.php");
include("../php/about.php");

$user_data=check_login($link);

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>theCreatives</title>

    <!-- main css -->
    <link rel="stylesheet" href="../css/profabout.css">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-uWxY/CJNBR+1zjPWmfnSnVxwRheevXITnMqoEIeG1LJrdI0GlVs/9cVSyPYXdcSF" crossorigin="anonymous">

    <!-- link for animate-->
    <link rel="stylesheet"href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <!-- link for font awesome -->
    <script src="https://kit.fontawesome.com/9334436048.js" crossorigin="anonymous"></script>



</head>
<body>
    <!-- header -->
    <style>a{text-decoration: none;}
    
    
    </style>
    <header class="header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-2 px-0">
                    <div class="header_logo">
                        <a href="explore.html"><span>the</span>Creatives</a>
                    </div>
                </div>
                <div class="col-lg-10 ">
                    <div class="header_right">
                        <div class="header_right_auth">
                            <a href="explore.html">Home</a>
                            <a href="../php/logout.php">Log Out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- profile -->
    <div id="content" class="container p-0">
        <div class="profile-header">
            <div class="profile-header-cover">
                <img src="../images/white.png" alt="" style="height: 100%;width: 100%;" id="my_image4"/>
            </div>
            <div class="profile-header-content">
                <div class="profile-header-img">
                    <img src="../images/empty.png" alt="" style="height: 100%;width: 100%;" id="my_image3"/>
                </div>
                <div class="profile-header-info">
                    <h4 class="m-t-sm" id="atusername"></h4>
                    <button class="btn btn-primary profile-button" id="btnc2" style="float: right;" onclick="brsclick(1)">Change</button>
                </div>
            </div>
    
            <ul class="profile-header-tab nav nav-tabs">
            

                <li class="nav-item"><a href="profshowc.html" class="nav-link" data-toggle="tab">SHOWCASE</a></li>
                <li class="nav-item"><a href="profabout.html" class="nav-link active show" data-toggle="tab">ABOUT</a></li>
                <li class="nav-item" id="artlist2"><a href="profeport.html" class="nav-link" data-toggle="tab">E-PORTFOLIO</a></li>
                <li class="nav-item" id="artlist3"><a href="proflistcomm.html" class="nav-link" data-toggle="tab">LIST OF COMMISSIONS</a></li>
                <li class="nav-item"><a href="proftrans.html" class="nav-link" data-toggle="tab">TRANSACTIONS</a></li>
                <li class="nav-item" id="artlist4"><a href="profearn.html" class="nav-link" data-toggle="tab">EARNINGS</a></li>
                <li class="nav-item" id="artlist5"><a href="profprice.html" class="nav-link" data-toggle="tab">PRICE LIST</a></li>
                <li class="nav-item"><a href="profcart.html" class="nav-link" data-toggle="tab">CART</a></li>
            </ul>
        </div>
        <!-- interface ng profile about -->
        <div class="profile-container">
            <div class="container rounded bg-white mt-5 mb-5">
                <div class="row">
                    <div class="col-md-3 border-right">
                        <div class="d-flex flex-column align-items-center text-center p-3 py-5">
                            <img class="" style="margin-bottom: 10px;" width="150px" height="150px" src="../images/empty.png" id="my_image2">
                            <input type="file" id="ifile" name="fileUpload" hidden>
                            
                            <button class="btn btn-primary profile-button" id="btnc" onclick="brsclick(0)">Change</button>
                            
                        </div>
                    </div>
                    <div class="col-md-5 border-right">
                        <div class="p-3 py-5">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h4 class="text-right">Profile Settings</h4>
                            </div>
                            <form id="form" action="#" method="post">
                                <input type="text" name="pic" id="pic" value="" hidden> 
                                <input type="text" name="coverpic" id="coverpic" value="" hidden> 
                            <div class="row mt-2">
                                <div class="col-md-12"><label class="labels">Username</label><input type="text" id="uname" name="uname" class="form-control" placeholder="username" value="" onchange="textchange(9, this.value)" ></div>
                                <div class="col-md-6"><label class="labels">Name</label><input type="text" id="fname" name="fname" class="form-control" placeholder="first name" value="" onchange="textchange(0, this.value)" ></div>
                                <div class="col-md-6"><label class="labels">Surname</label><input type="text" id="lname"name="lname" class="form-control" placeholder="surname" value="" onchange="textchange(1, this.value)" ></div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-12"><label class="labels">Mobile Number</label><input type="text" class="form-control" placeholder="enter phone number" value="" id="phone" name="contno" onchange="textchange(2, this.value)" maxlength="10"></input></div>
                                <div class="col-md-12"><label class="labels">Address</label><input type="text" class="form-control" placeholder="enter address" value="" id="add" name="add" onchange="textchange(3, this.value)"></input></div>
                                <div class="col-md-12"><label class="labels">Email ID</label><input type="text" class="form-control" placeholder="enter email id" id ="email" name ="email" value="" onchange="textchange(4, this.value)" ></div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-6"><label class="labels">Country</label><input type="text" class="form-control" placeholder="country" value="" id="country" name="country" onchange="textchange(5, this.value)" ></input></div>
                                <div class="col-md-6"><label class="labels">State/Region</label><input type="text" class="form-control" value="" placeholder="state" id="state" name="state" onchange="textchange(6, this.value)"></input></div>
                            </div>
                            
                           

                            <div class="mt-5 text-center">
                                <button class="btn btn-primary profile-button" type="submit" id="submit" disabled>Save Profile</button>
                                <button class="btn btn-secondary profile-button" type="button" id="cancel" disabled>Clear</button>
                            </div>
                        </div>
                        
                    </div>
                    <div class="col-md-4">
                        <div class="p-3 py-5" id="expert">
                            
                            <div class="d-flex justify-content-between align-items-center experience"><span>Artist Expertise</span></div><br>
                            <div class="col-md-12"><label class="labels">Expertise in</label><input type="text" id="exp" name="exp" class="form-control" placeholder="expertise" value="" onchange="textchange(7, this.value)" ></input></div> <br>
                            <div class="col-md-12"><label class="labels">Additional Details</label><input id="addet" name="addet" type="text" class="form-control" placeholder="additional details" value="" onchange="textchange(8, this.value)"></input></div>
                            <hr>
                            <h5 class="text-right">Gcash Details</h5>
                         
                                <div class="col-md-12"><label class="labels">Gcash Name</label><input type="text" class="form-control" placeholder="gcash name" value="" id="gname" name="gname" onchange="textchange(10, this.value)" ></input></div>
                                <div class="col-md-12"><label class="labels">Gcash Number</label><input type="text" class="form-control" value="" placeholder="gcash number" id="gnum" name="gnum" onchange="textchange(11, this.value)"></input></div>
          
                        </form>
                        </div>
                    </div>
                    
                </div>
            </div>
            
        </div>
	
	

    </div>
    <!-- js for bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-kQtW33rZJAHjgefvhyyzcGF3C5TFyBQBA13V1RKPf4uH+bwyzQxZ6CmMZHmNBEfJ" crossorigin="anonymous"></script>
    <script>
        var interc=false;
        var num=0;
        var imgbase64;
        var z=0;
        var usertype="<?php echo $about_usertype;?>";

        const ifile=document.getElementById("ifile");
     
        const brs=document.getElementById("btnc");
        const brsc=document.getElementById("btnc2");
        const img=document.querySelector('#my_image2');
        const img2=document.querySelector('#my_image3');
        const img3=document.querySelector('#my_image4');
        function brsclick(x){
            z=x;
            ifile.click();
         
        }
        ifile.addEventListener('change', function(event){
            document.getElementById("submit").disabled = false;
                document.getElementById("cancel").disabled = false;
                interc=false;

          const uploadedFile = document.querySelector('#ifile').files[0];
		      toBase64(uploadedFile)
		      .then(res => {
          imgbase64=res;
                if(z==0){
                    document.getElementById("pic").value=imgbase64;

                }else{
                    document.getElementById("coverpic").value=imgbase64;
                    console.log(imgbase64);
                }
        

	      	})
		      .catch(err => {
            imgbase64="";

            if(z==0){
                    document.getElementById("pic").value=imgbase64;

                }else{
                    document.getElementById("coverpic").value=imgbase64;
                }

	    	  })
        });

      const toBase64 = file => new Promise((resolve, reject) => {
	    const reader = new FileReader();
      reader.addEventListener('load', function(){
              
              if(z==0){
                img.setAttribute('src',reader.result);

                }else{
                    img3.setAttribute('src',reader.result);;
                }

              txt.value=ifile.value.match(/[\/\\]([\w\d\s\.\-\(\)]+)$/)[1];

            });

	    reader.readAsDataURL(file);
	    reader.onload = () => resolve(reader.result);
	    reader.onerror = error => reject(error);
	      });


            window.addEventListener('load', function(event){
                loadinput();
             });

          
            
        if (usertype=="user"){

document.getElementById("expert").hidden=true;
document.getElementById("artlist2").hidden=true;
document.getElementById("artlist3").hidden=true;
document.getElementById("artlist4").hidden=true;
document.getElementById("artlist5").hidden=true;

}else{
document.getElementById("expert").hidden=false;
document.getElementById("artlist2").hidden=false;
document.getElementById("artlist3").hidden=false;
document.getElementById("artlist4").hidden=false;
document.getElementById("artlist5").hidden=false;

}
            function loadinput(){
               var propic="<?php echo $about_pic;?>";
               var covpic="<?php echo $about_coverpic;?>";
                document.getElementById("fname").value=inparray[0];
         document.getElementById("lname").value=inparray[1];
         document.getElementById("phone").value=inparray[2];
         document.getElementById("add").value=inparray[3];
         document.getElementById("email").value=inparray[4];
         document.getElementById("state").value=inparray[6];
         document.getElementById("country").value=inparray[5];
         document.getElementById("exp").value=inparray[7];
         document.getElementById("addet").value=inparray[8];
         document.getElementById("uname").value=inparray[9];
         document.getElementById("atusername").innerHTML="@"+inparray[9];
         document.getElementById("gname").value=inparray[10];
         document.getElementById("gnum").value=inparray[11];
         if (!propic==""){
             
            document.getElementById("pic").value=propic; 
            img.setAttribute('src',propic); 
            img2.setAttribute('src',propic); 

         }else{
            document.getElementById("pic").value=propic; 
            img.setAttribute('src',"../images/empty.png"); 
            img2.setAttribute('src',"../images/empty.png"); 
         }

         if (!covpic==""){
             
             document.getElementById("coverpic").value=covpic; 
             img3.setAttribute('src',covpic); 
 
          }else{
             document.getElementById("coverpic").value=covpic; 
             img3.setAttribute('src',"../images/white.png"); 

          }
        
            }

            const inparray = [

            "<?php echo $about_fname;?>",
			"<?php echo $about_lname;?>",
            "<?php echo $about_contno;?>",
	        "<?php echo $about_address;?>",
			"<?php echo $about_email;?>",
            "<?php echo $about_country;?>",
			"<?php echo $about_state;?>",
            "<?php echo $about_exp;?>",
            "<?php echo $about_addet;?>",
            "<?php echo $about_uname;?>",
            "<?php echo $about_gname;?>",
            "<?php echo $about_gnum;?>"
            ]

		function textchange(x, str) {

            var p1=inparray[x];
            var p2=str;

            var result = p1.localeCompare(p2);

            if (result==0){
  num+=1;

}else{
  num-=1;

}

if (num==0){

    document.getElementById("submit").disabled = true;
    document.getElementById("cancel").disabled = true;
    interc=false;
}else{

    document.getElementById("submit").disabled = false;
    document.getElementById("cancel").disabled = false;
    interc=true;
}
		}
        document.getElementById("cancel").addEventListener('click', function(event){
            loadinput();

            document.getElementById("submit").disabled = true;
                document.getElementById("cancel").disabled = true;
                img.setAttribute('src',"../images/empty.png");
          txt.value="";
          imgbase64="";

             });



	</script>
</body>
</html>